<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Chat Interface Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .chat-interface {
            border: 2px solid #007bff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            background: #f8f9fa;
        }
        .chat-interface iframe {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Enhanced Chat Interface Test</h1>
        <p style="text-align: center; color: #666;">
            Editor ‡¶≠‡¶æ‡¶á-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø Smart Prompt Orchestration System Test
        </p>

        <div class="test-section">
            <h3>üîç System Status Tests</h3>
            <button class="test-button" onclick="testNextJSServer()">Test Next.js Server</button>
            <button class="test-button" onclick="testOrchestratorServer()">Test Orchestrator Server</button>
            <button class="test-button" onclick="testAllServices()">Test All Services</button>
            <div id="status-results"></div>
        </div>

        <div class="test-section">
            <h3>üí¨ Chat API Tests</h3>
            <button class="test-button" onclick="testBengaliChat()">Test Bengali Chat</button>
            <button class="test-button" onclick="testEnglishChat()">Test English Chat</button>
            <button class="test-button" onclick="testMixedLanguage()">Test Mixed Language</button>
            <div id="chat-results"></div>
        </div>

        <div class="test-section">
            <h3>üéØ Live Chat Interface</h3>
            <p>Click the button below to open the live chat interface:</p>
            <button class="test-button" onclick="openChatInterface()">Open Chat Interface</button>
            <div class="chat-interface">
                <iframe id="chatFrame" src="http://localhost:3000" style="display: none;"></iframe>
                <div id="chatPlaceholder" style="text-align: center; padding: 50px; color: #666;">
                    Click "Open Chat Interface" to load the chat
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üìä Test Results Summary</h3>
            <div id="summary-results"></div>
        </div>
    </div>

    <script>
        let testResults = {
            nextjs: false,
            orchestrator: false,
            bengali: false,
            english: false,
            mixed: false
        };

        async function testNextJSServer() {
            const resultsDiv = document.getElementById('status-results');
            try {
                const response = await fetch('http://localhost:3000');
                if (response.ok) {
                    resultsDiv.innerHTML += '<div class="result success">‚úÖ Next.js Server is running on port 3000</div>';
                    testResults.nextjs = true;
                } else {
                    resultsDiv.innerHTML += '<div class="result error">‚ùå Next.js Server returned status: ' + response.status + '</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML += '<div class="result error">‚ùå Next.js Server is not accessible: ' + error.message + '</div>';
            }
            updateSummary();
        }

        async function testOrchestratorServer() {
            const resultsDiv = document.getElementById('status-results');
            try {
                const response = await fetch('http://localhost:3004/api/health');
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += '<div class="result success">‚úÖ Orchestrator Server is running on port 3004</div>';
                    testResults.orchestrator = true;
                } else {
                    resultsDiv.innerHTML += '<div class="result error">‚ùå Orchestrator Server returned status: ' + response.status + '</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML += '<div class="result error">‚ùå Orchestrator Server is not accessible: ' + error.message + '</div>';
            }
            updateSummary();
        }

        async function testAllServices() {
            const resultsDiv = document.getElementById('status-results');
            resultsDiv.innerHTML += '<div class="result info">üîÑ Testing all services...</div>';
            
            await testNextJSServer();
            await testOrchestratorServer();
            
            // Test other services
            const services = [
                { name: 'AI Server', url: 'http://localhost:3001/health' },
                { name: 'TTS Server', url: 'http://localhost:3002/health' },
                { name: 'Memory Server', url: 'http://localhost:3003/health' }
            ];
            
            for (const service of services) {
                try {
                    const response = await fetch(service.url);
                    if (response.ok) {
                        resultsDiv.innerHTML += '<div class="result success">‚úÖ ' + service.name + ' is running</div>';
                    } else {
                        resultsDiv.innerHTML += '<div class="result error">‚ùå ' + service.name + ' returned status: ' + response.status + '</div>';
                    }
                } catch (error) {
                    resultsDiv.innerHTML += '<div class="result error">‚ùå ' + service.name + ' is not accessible</div>';
                }
            }
        }

        async function testBengaliChat() {
            const resultsDiv = document.getElementById('chat-results');
            try {
                const response = await fetch('http://localhost:3000/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: "‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ï‡ßá‡¶Æ‡¶®?",
                        history: [],
                        conversationId: "test_bengali",
                        userId: "test_user"
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += '<div class="result success">‚úÖ Bengali Chat Test Passed\nResponse: ' + data.response.substring(0, 100) + '...</div>';
                    testResults.bengali = true;
                } else {
                    resultsDiv.innerHTML += '<div class="result error">‚ùå Bengali Chat Test Failed: ' + response.status + '</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML += '<div class="result error">‚ùå Bengali Chat Test Error: ' + error.message + '</div>';
            }
            updateSummary();
        }

        async function testEnglishChat() {
            const resultsDiv = document.getElementById('chat-results');
            try {
                const response = await fetch('http://localhost:3000/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: "Hello, how are you today?",
                        history: [],
                        conversationId: "test_english",
                        userId: "test_user"
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += '<div class="result success">‚úÖ English Chat Test Passed\nResponse: ' + data.response.substring(0, 100) + '...</div>';
                    testResults.english = true;
                } else {
                    resultsDiv.innerHTML += '<div class="result error">‚ùå English Chat Test Failed: ' + response.status + '</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML += '<div class="result error">‚ùå English Chat Test Error: ' + error.message + '</div>';
            }
            updateSummary();
        }

        async function testMixedLanguage() {
            const resultsDiv = document.getElementById('chat-results');
            try {
                const response = await fetch('http://localhost:3000/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: "‡¶Ü‡¶Æ‡¶æ‡¶∞ Python code ‡¶è error ‡¶Ü‡¶∏‡¶õ‡ßá",
                        history: [],
                        conversationId: "test_mixed",
                        userId: "test_user"
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += '<div class="result success">‚úÖ Mixed Language Chat Test Passed\nResponse: ' + data.response.substring(0, 100) + '...</div>';
                    testResults.mixed = true;
                } else {
                    resultsDiv.innerHTML += '<div class="result error">‚ùå Mixed Language Chat Test Failed: ' + response.status + '</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML += '<div class="result error">‚ùå Mixed Language Chat Test Error: ' + error.message + '</div>';
            }
            updateSummary();
        }

        function openChatInterface() {
            const frame = document.getElementById('chatFrame');
            const placeholder = document.getElementById('chatPlaceholder');
            
            frame.style.display = 'block';
            placeholder.style.display = 'none';
            frame.src = 'http://localhost:3000';
        }

        function updateSummary() {
            const summaryDiv = document.getElementById('summary-results');
            const passed = Object.values(testResults).filter(Boolean).length;
            const total = Object.keys(testResults).length;
            
            let summary = `üìä Test Results: ${passed}/${total} tests passed\n\n`;
            
            summary += `‚úÖ Next.js Server: ${testResults.nextjs ? 'PASS' : 'FAIL'}\n`;
            summary += `‚úÖ Orchestrator Server: ${testResults.orchestrator ? 'PASS' : 'FAIL'}\n`;
            summary += `‚úÖ Bengali Chat: ${testResults.bengali ? 'PASS' : 'FAIL'}\n`;
            summary += `‚úÖ English Chat: ${testResults.english ? 'PASS' : 'FAIL'}\n`;
            summary += `‚úÖ Mixed Language: ${testResults.mixed ? 'PASS' : 'FAIL'}\n\n`;
            
            if (passed === total) {
                summary += 'üéâ ALL TESTS PASSED! System is ready for use!';
            } else {
                summary += '‚ö†Ô∏è Some tests failed. Please check the services.';
            }
            
            summaryDiv.innerHTML = '<div class="result ' + (passed === total ? 'success' : 'error') + '">' + summary + '</div>';
        }

        // Auto-run basic tests on page load
        window.onload = function() {
            setTimeout(() => {
                testNextJSServer();
                testOrchestratorServer();
            }, 1000);
        };
    </script>
</body>
</html>

